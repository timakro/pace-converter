<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pace Converter</title>
  <meta name="description" content="Convert from minute miles to km/h and more">
  <link rel="icon" type="image/png" href="favicon.png">

  <style>
    :root {
      --bg-color: #f2cf90;
      --card-bg-color: #ffe4bb;
      --text-color: #332a21;
      --border-color: #c6bbaf;
    }

    @media (min-width: 370px) {
      html {
        font-size: 130%;
      }
    }

    @media (min-width: 420px) {
      html {
        font-size: 150%;
      }
    }

    /* ---- hide number input's spin buttons ---- */
    /* https://stackoverflow.com/a/4298216 */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      /* display: none; <- Crashes Chrome on hover */
      -webkit-appearance: none;
      margin: 0;
      /* <-- Apparently some margin are still there even though it's hidden */
    }

    input[type=number] {
      -moz-appearance: textfield;
      /* Firefox */
    }
  </style>
</head>

<body
  style="font-family: sans-serif; background-color: var(--bg-color); color: var(--text-color); display: grid; grid-template-columns: repeat(2, minmax(100px, 200px)); justify-content: center; gap: 0.7rem; margin: 0.7rem;">

  <header style="grid-column: 1 / -1; display: flex; justify-content: center; align-items: center; gap: 0.4rem;">
    <svg width="2rem" height="2rem" version="1.1" viewBox="0 0 1300 1300" xmlns="http://www.w3.org/2000/svg">
      <g>
        <circle cx="650" cy="650" r="465.38" fill="#95bde4" />
        <path
          d="m903.72 1020.7c-23.685-27.397 3.1964-66.659-18.39-98.782-4.9912-34.192-26.074-63.257-36.4-92.891-12.568-20.973-22.822-41.483-28.071-63.142 9.0789-36.698-30.914-37.847-53.119-52.119-29.09-2.5294-60.628-40.633-86.188-19.146-11.958 14.259-19.418 34.454-30.175 45.353-28.257 29.025-48.631 68.88-83.541 92.375-75.191 18.723-154.5 2.9129-230.54 17.213-37.591-5.5739-69.654 45.349-86.108 48.848-9.8973-12.679-56.514 40.401-57.52-5.2922 2.4628-46.188 53.986-57.271 72.712-93.106 31.296-35.172 47.858 34.706 82.291 3.0171 39.786-13.662 79.227-30.269 120.94-35.699 34.102 5.6537 84.423 10.422 80.177-38.31 9.5005-36.817 43.894-64.185 36.94-104.87-4.9183-49.89 49.642-76.355 57.027-115.91 2.7877-31.254 18.451-70.223-27.262-73.934-32.427-10.674-71.616-48.213-22.963-68.001 26.389-26.675 75.415-22.479 82.68-65.116 24.77-2.5823 61.2-22.803 28.434-45.585-24.329-33.263-24.444-95.667 21.749-109.98 32.316-12.735 93.633-9.8645 98.477 33.043-17.879 24.946 4.3809 56.24-1.0067 78.945-8.1739 22.446-14.747 48.086-44.417 49.798-24.186 38.327 19.879 27.046 38.209 18.946 44.36 42.28-31.096 69.114-31.079 110.81-8.4907 40.875-13.102 82.914-29.326 121.99-12.943 42.986 39.248 63.743 68.518 82.295 17.115 26.736 50.341 40.571 57.965 74.104 14.953 35.062 27.573 72.703 26.468 111.66 8.505 41.403 11.984 88.451 38.508 122.43 26.513 7.2862 51.357 27.208 82.536 20.722 34.2 28.241-34.652 49.529-56.662 46.059-22.26-9.5492-49.463 13.305-70.87 4.2869z"
          fill="#332a21" />
      </g>
    </svg>
    <h1 style="font-size: 1rem; margin: 0;">Pace Converter</h1>
  </header>

  <div style="background-color: var(--card-bg-color); border-radius: 0.5rem;">
    <h2 style="font-size: 1.2rem; margin: 0.5rem; text-align: center;">min/mile</h2>
    <div style="display: flex; justify-content: center; gap: 0.2rem; font-size: 1.7rem; margin: 0.7rem;">
      <input type="number" id="mm1" step="1" min="0" max="99" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 1.5em;">
      :
      <input type="number" id="mm2" step="1" min="0" max="59" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 1.5em;">
    </div>
  </div>

  <div style="background-color: var(--card-bg-color); border-radius: 0.5rem;">
    <h2 style="font-size: 1.2rem; margin: 0.5rem; text-align: center;">min/km</h2>
    <div style="display: flex; justify-content: center; gap: 0.2rem; font-size: 1.7rem; margin: 0.7rem;">
      <input type="number" id="mk1" step="1" min="0" max="99" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 1.5em;">
      :
      <input type="number" id="mk2" step="1" min="0" max="59" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 1.5em;">
    </div>
  </div>

  <div style="background-color: var(--card-bg-color); border-radius: 0.5rem;">
    <h2 style="font-size: 1.2rem; margin: 0.5rem; text-align: center;">mph</h2>
    <div style="display: flex; justify-content: center; gap: 0.2rem; font-size: 1.7rem; margin: 0.7rem;">
      <input type="number" id="mph" step="0.01" min="0" max="99.99" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 3em;">
    </div>
  </div>

  <div style="background-color: var(--card-bg-color); border-radius: 0.5rem;">
    <h2 style="font-size: 1.2rem; margin: 0.5rem; text-align: center;">km/h</h2>
    <div style="display: flex; justify-content: center; gap: 0.2rem; font-size: 1.7rem; margin: 0.7rem;">
      <input type="number" id="kmh" step="0.01" min="0" max="99.99" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 3em;">
    </div>
  </div>

  <div style="background-color: var(--card-bg-color); border-radius: 0.5rem; grid-column: 1 / -1;">
    <h2 style="font-size: 1.2rem; margin: 0.5rem; text-align: center;">miles and hours</h2>
    <div style="display: flex; justify-content: center; gap: 0.2rem; font-size: 1.7rem; margin: 0.7rem;">
      <input type="number" id="mi0" step="0.01" min="0" max="99.99" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 3em;">
      <span style="font-size: 1rem; align-self: center; margin: 0 0.4rem;">in</span>
      <input type="number" id="mi1" step="1" min="0" max="99" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 1.5em;">
      :
      <input type="number" id="mi2" step="1" min="0" max="59" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 1.5em;">
    </div>
  </div>

  <div style="background-color: var(--card-bg-color); border-radius: 0.5rem; grid-column: 1 / -1;">
    <h2 style="font-size: 1.2rem; margin: 0.5rem; text-align: center;">kilometers and hours</h2>
    <div style="display: flex; justify-content: center; gap: 0.2rem; font-size: 1.7rem; margin: 0.7rem;">
      <input type="number" id="km0" step="0.01" min="0" max="99.99" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 3em;">
      <span style="font-size: 1rem; align-self: center; margin: 0 0.4rem;">in</span>
      <input type="number" id="km1" step="1" min="0" max="99" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 1.5em;">
      :
      <input type="number" id="km2" step="1" min="0" max="59" required
        style="font-family: inherit; font-size: inherit; color: inherit; text-align: center; border: 1px solid var(--border-color); border-radius: 0.4rem; width: 1.5em;">
    </div>
  </div>

  <script>
    const mm1 = document.getElementById('mm1');
    const mm2 = document.getElementById('mm2');
    const mk1 = document.getElementById('mk1');
    const mk2 = document.getElementById('mk2');
    const mph = document.getElementById('mph');
    const kmh = document.getElementById('kmh');
    const mi0 = document.getElementById('mi0');
    const mi1 = document.getElementById('mi1');
    const mi2 = document.getElementById('mi2');
    const km0 = document.getElementById('km0');
    const km1 = document.getElementById('km1');
    const km2 = document.getElementById('km2');

    /* conversion logic */

    // https://en.wikipedia.org/wiki/Mile
    const KmPerMile = 1.609344;

    function setDuration(input1, input2, duration) {
      duration = Math.round(duration);
      const pad = n => ('00' + n).slice(-2);
      input1.value = pad(Math.floor(duration / 60));
      input2.value = pad(duration % 60);
    }

    function setDistance(input, distance) {
      input.value = distance.toFixed(2);
    }

    mm1.onchange = mm2.onchange = () => {
      if (mm1.reportValidity() && mm2.reportValidity()) {
        const secondsPerMile = mm1.valueAsNumber * 60 + mm2.valueAsNumber;
        setDuration(mk1, mk2, secondsPerMile / KmPerMile);
        setDistance(mph, 3600 / secondsPerMile);
        setDistance(kmh, 3600 / secondsPerMile * KmPerMile);
        mi0.value = mi1.value = mi2.value = '';
        km0.value = km1.value = km2.value = '';
      }
    };

    mk1.onchange = mk2.onchange = () => {
      if (mk1.reportValidity() && mk2.reportValidity()) {
        const secondsPerKm = mk1.valueAsNumber * 60 + mk2.valueAsNumber;
        setDuration(mm1, mm2, secondsPerKm * KmPerMile);
        setDistance(mph, 3600 / secondsPerKm / KmPerMile);
        setDistance(kmh, 3600 / secondsPerKm);
        mi0.value = mi1.value = mi2.value = '';
        km0.value = km1.value = km2.value = '';
      }
    };

    mph.onchange = () => {
      if (mph.reportValidity()) {
        const milesPerHour = mph.valueAsNumber;
        setDuration(mm1, mm2, 3600 / milesPerHour);
        setDuration(mk1, mk2, 3600 / milesPerHour / KmPerMile);
        setDistance(kmh, milesPerHour * KmPerMile);
        mi0.value = mi1.value = mi2.value = '';
        km0.value = km1.value = km2.value = '';
      }
    };

    kmh.onchange = () => {
      if (kmh.reportValidity()) {
        const kmPerHour = kmh.valueAsNumber;
        setDuration(mm1, mm2, 3600 / kmPerHour * KmPerMile);
        setDuration(mk1, mk2, 3600 / kmPerHour);
        setDistance(mph, kmPerHour / KmPerMile);
        mi0.value = mi1.value = mi2.value = '';
        km0.value = km1.value = km2.value = '';
      }
    };

    mi0.onchange = mi1.onchange = mi2.onchange = () => {
      if (mi0.reportValidity() && mi1.reportValidity() && mi2.reportValidity()) {
        const minutesPerMile = (mi1.valueAsNumber * 60 + mi2.valueAsNumber) / mi0.valueAsNumber;
        setDuration(mm1, mm2, minutesPerMile * 60);
        setDuration(mk1, mk2, minutesPerMile * 60 / KmPerMile);
        setDistance(mph, 60 / minutesPerMile);
        setDistance(kmh, 60 / minutesPerMile * KmPerMile);
        km0.value = km1.value = km2.value = '';
      }
    };

    km0.onchange = km1.onchange = km2.onchange = () => {
      if (km0.reportValidity() && km1.reportValidity() && km2.reportValidity()) {
        const minutesPerKm = (km1.valueAsNumber * 60 + km2.valueAsNumber) / km0.valueAsNumber;
        setDuration(mm1, mm2, minutesPerKm * 60 * KmPerMile);
        setDuration(mk1, mk2, minutesPerKm * 60);
        setDistance(mph, 60 / minutesPerKm / KmPerMile);
        setDistance(kmh, 60 / minutesPerKm);
        mi0.value = mi1.value = mi2.value = '';
      }
    };

    /* ergonomics */

    function selectOnFocus(input) {
      input.onfocus = input.onclick = input.select;
    }

    function limitToTwoDigits(input) {
      if (input.value.length > 2) {
        input.value = input.value.slice(0, 2);
      }
      return input.value.length >= 2;
    }

    function durationInput(input1, input2) {
      selectOnFocus(input1);
      selectOnFocus(input2);
      input1.oninput = () => {
        if (limitToTwoDigits(input1)) {
          input2.focus();
        }
      };
      input2.oninput = () => {
        if (limitToTwoDigits(input2)) {
          input2.blur();
        }
      };
    }

    function limitToTwoDecimalPoints(input) {
      const limit = input.value.indexOf('.') !== -1 ? input.value.indexOf('.') + 3 : 2;
      if (input.value.length > limit) {
        input.value = input.value.slice(0, limit);
      }
      return input.value.indexOf('.') !== -1 && input.value.length >= input.value.indexOf('.') + 3;
    }

    function distanceInput(input) {
      selectOnFocus(input);
      input.oninput = () => {
        if (limitToTwoDecimalPoints(input)) {
          input.blur();
        }
      };
    }

    function combinedInput(input0, input1, input2) {
      selectOnFocus(input0);
      input0.oninput = () => {
        if (limitToTwoDecimalPoints(input0)) {
          input1.focus();
        }
      };
      durationInput(input1, input2);
    }

    durationInput(mm1, mm2);
    durationInput(mk1, mk2);
    distanceInput(mph);
    distanceInput(kmh);
    combinedInput(mi0, mi1, mi2);
    combinedInput(km0, km1, km2);
  </script>

  <footer style="grid-column: 1 / -1; font-size: 0.7rem; text-align: center;">
    Made by <a href="https://github.com/timakro">Tim</a> &middot;
    Code on <a href="https://github.com/timakro/pace-converter">GitHub</a>
  </footer>
</body>

</html>
